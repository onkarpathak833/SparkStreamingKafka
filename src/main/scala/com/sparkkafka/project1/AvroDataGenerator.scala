package com.sparkkafka.project1

import java.io.ByteArrayOutputStream

import com.typesafe.config.Config
import org.apache.avro.Schema
import org.apache.avro.Schema.Parser
import org.apache.avro.generic.{GenericData, GenericRecord}
import org.apache.avro.io.{BinaryEncoder, EncoderFactory}
import org.apache.avro.specific.SpecificDatumWriter

import scala.util.parsing.json.JSONObject

class AvroDataGenerator {

  val eventSchema = "{\n  \"type\":\"record\",\n  \"name\":\"Event\",\n  \"namespace\":\"com.catalina.platform.avro\",\n  \"fields\":[\n    {\n      \"name\":\"cid\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"The id of the consumer this event is correlated with\"\n    },\n    {\n      \"name\":\"device_id\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"This anonymously identifies a particular user, device, or browser instance. For the web, this is generally stored as a first-party cookie with a two-year expiration. For mobile apps, this is randomly generated for each particular instance of an application install. The value of this field should be a random UUID (version 4) as described in http://www.ietf.org/rfc/rfc4122.txt\"\n    },\n    {\n      \"name\":\"time\",\n      \"type\":[\n        \"null\",\n        \"long\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"The time (UTC) in milliseconds since epoch. In Java new Date().getTime()\"\n    },\n    {\n      \"name\":\"source_ids\",\n      \"type\":[\"null\",{\n        \"type\":\"array\",\n        \"items\":\"string\"\n      }],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"The unique advertisement identifiers correlated with this event (offer, ad, mclu, etc)\"\n    },\n    {\n      \"name\":\"type\",\n      \"type\":{\n        \"type\":\"enum\",\n        \"name\":\"EventType\",\n        \"doc\":\"The type of event\",\n        \"symbols\":[\n          \"redemption\",\n          \"impression\",\n          \"click\",\n          \"checkout\",\n          \"media_delivery\",\n          \"visit\",\n          \"control\",\n          \"system\",\n          \"conversion\",\n          \"non_conversion\",\n          \"pin\",\n          \"threshold\",\n          \"pageview\",\n          \"screenview\",\n          \"item\",\n          \"social\",\n          \"exception\",\n          \"print\",\n          \"cart\",\n          \"wallet\",\n          \"goal\",\n          \"detection\",\n          \"notifications\",\n          \"download\",\n          \"clip\"\n        ]\n      },\n      \"default\": \"system\",\n      \"order\":\"ascending\",\n      \"doc\":\"The type of event that was triggered from redemption of a coupon, to an impression, to a generic tracking event\"\n    },\n    {\n      \"name\":\"system_id\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"The unique system identifier that was responsible for generating this event\"\n    },\n    {\n      \"name\":\"media_type\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"The type of media delivered or correlated with this particular event, for example 'ad' or 'coupon'\"\n    },\n    {\n      \"name\":\"model\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"The type of scoring model or distribution model correlated to this particular event\"\n    },\n    {\n      \"name\":\"channel_type\",\n      \"type\":{\n        \"type\":\"enum\",\n        \"name\":\"ChannelType\",\n        \"symbols\":[\n          \"mobile\",\n          \"store\",\n          \"web\",\n          \"video\",\n          \"email\",\n          \"app\",\n          \"kiosk\",\n          \"direct\",\n          \"other\"\n        ]\n      },\n      \"default\": \"other\",\n      \"order\":\"ascending\",\n      \"doc\":\"The channel which is correlated with this event\"\n    },\n    {\n      \"name\":\"session_id\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"The unique session identifier used to correlate multiple events together as part of an overall click-stream, web-session, or transaction. Includes attribution and conversion modeling where impression can be delivered days ago and conversion is associated to the original session\"\n    },\n    {\n      \"name\":\"site_id\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"The unique identifier for where this event was triggered (for store this is the store #, for websites, the affiliate or web property id)\"\n    },\n    {\n      \"name\":\"network_id\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"The unique identifier for where this event was triggered (for store this is chain #, for websites, the network or affiliate id)\"\n    },\n    {\n      \"name\":\"lane_id\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"The unique identifier for the lane which generated this event, only applicable if a store event\"\n    },\n    {\n      \"name\":\"latitude\",\n      \"type\":[\n        \"null\",\n        \"float\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"The latitude where the user was when this event was generated in the format: 27.9710,82.4650\"\n    },\n    {\n      \"name\":\"longitude\",\n      \"type\":[\n        \"null\",\n        \"float\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"The latitude where the user was when this event was generated in the format: 27.9710,82.4650\"\n    },\n    {\n      \"name\":\"shopper_type\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"The type of shopper and/or classification of the shopper at the time the event was triggered (for example; 'new', 'abusive', 'control')\"\n    },\n    {\n      \"name\":\"campaign_id\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"A campaign id associate to the media distributed\"\n    },\n    {\n      \"name\":\"campaign_name\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"Specifies the campaign name. Example (direct)\"\n    },\n    {\n      \"name\":\"campaign_keyword\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"Specifies the campaign keyword.\"\n    },\n    {\n      \"name\":\"advertiser_id\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"The advertiser that was associate to this event due to its media being generated, this could be retailer if retailer provided content or a manufacturer # given a manufacturer program\"\n    },\n    {\n      \"name\":\"ad_group_id\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"Optional ad group identifier for the collection of media shown to a user (aka: award)\"\n    },\n    {\n      \"name\":\"ad_creative_set_id\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"The ID of the creative set used when displaying to the user a collection of ids (aka: mclu)\"\n    },\n    {\n      \"name\":\"conversion_total_purchased_amount\",\n      \"type\":[\n        \"null\",\n        \"double\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"aliases\":[\"purchased_amount\"],\n      \"doc\":\"A number representing the value that placed on the conversion. It could reflect a currency value, quantity, weighted value, or dollar value\"\n    },\n    {\n      \"name\":\"conversion_total_purchased_qty\",\n      \"type\":[\n        \"null\",\n        \"int\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"aliases\":[\"purchased_qty\"],\n      \"doc\":\"A number representing the overall conversion quantity (units sold based on conversion)\"\n    },\n    {\n      \"name\":\"conversion_purchased_upcs\",\n      \"type\":[\"null\",{\n        \"type\":\"array\",\n        \"items\":\"string\"\n      }],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"aliases\":[\"purchased_upcs\"],\n      \"doc\":\"The upcs associated with the conversion event and attributed to the conversion quantity and dollar value\"\n    },\n    {\n      \"name\":\"event_value\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"Specifies the event value. Values must be non-negative.\"\n    },\n    {\n      \"name\":\"event_label\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"Specifies the event label.\"\n    },\n    {\n      \"name\":\"event_action\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"Specifies the event action. Must not be empty.\"\n    },\n    {\n      \"name\":\"event_category\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"Specifies the event category. Must not be empty.\"\n    },\n    {\n      \"name\":\"exception_fatal\",\n      \"type\":[\n        \"null\",\n        \"boolean\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"Specifies whether the exception was fatal.\"\n    },\n    {\n      \"name\":\"ttl\",\n      \"type\":[\n        \"null\",\n        \"int\"\n      ],\n      \"default\":null,\n      \"order\":\"ignore\",\n      \"doc\":\"TTL length in seconds, will automatically delete rows once the expiration time is reached.\"\n    },\n    {\n      \"name\":\"social_network\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"Specifies the social network, for example Facebook or Google Plus.\"\n    },\n    {\n      \"name\":\"social_action\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"Specifies the social interaction action. For example on Google Plus when a user clicks the +1 button, the social action is 'plus'.\"\n    },\n    {\n      \"name\":\"social_action_target\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"Specifies the target of a social interaction. This value is typically a URL but can be any text.\"\n    },\n    {\n      \"name\":\"doc_host\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"Specifies the hostname from which content was hosted.\"\n    },\n    {\n      \"name\":\"doc_path\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"The path portion of the page URL. Should begin with '/'.\"\n    },\n    {\n      \"name\":\"doc_title\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"The title of the page / document.\"\n    },\n    {\n      \"name\":\"doc_referrer\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"Specifies which referral source brought traffic to a website. This value is also used to compute the traffic source. The format of this value is a URL.\"\n    },\n    {\n      \"name\":\"mobile_app_name\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"Specifies the application name\"\n    },\n    {\n      \"name\":\"mobile_app_id\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"Application identifier.\"\n    },\n    {\n      \"name\":\"mobile_app_version\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"Specifies the application version.\"\n    },\n    {\n      \"name\":\"category_level_1\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"ordering\": \"ignore\",\n      \"doc\":\"The 1st level in a category taxonomy. For example in the taxonomy GROCERY > PET FOOD > CAT FOOD > DRY CAT FOOD this would be 'GROCERY'\"\n    },\n    {\n      \"name\":\"category_level_2\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"ordering\": \"ignore\",\n      \"doc\":\"The 2nd level in a category taxonomy. For example in the taxonomy GROCERY > PET FOOD > CAT FOOD > DRY CAT FOOD this would be 'PET FOOD'\"\n    },\n    {\n      \"name\":\"category_level_3\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"ordering\": \"ignore\",\n      \"doc\":\"The 3rd level in a category taxonomy. For example in the taxonomy GROCERY > PET FOOD > CAT FOOD > DRY CAT FOOD this would be 'CAT FOOD'\"\n    },\n    {\n      \"name\":\"category_level_4\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"ordering\": \"ignore\",\n      \"doc\":\"The 4th level in a category taxonomy. For example in the taxonomy GROCERY > PET FOOD > CAT FOOD > DRY CAT FOOD this would be 'DRY CAT FOOD'\"\n    },\n    {\n      \"name\":\"user_ip\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"The IP address of the user (if applicable to channel) used to inject lat/long if not provided through direct interaction (GPS/Phone vs. Browser)\"\n    },\n    {\n      \"name\":\"id\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ignore\",\n      \"doc\":\"The unique ID of this event for correlation and duplicate detection\"\n    },\n    {\n      \"name\":\"country_code\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ascending\",\n      \"doc\":\"The country code where this event is generated against\"\n    },\n    {\n      \"name\":\"custom_attributes\",\n      \"type\": [\"null\", { \"type\" : \"map\", \"values\":\"string\" }],\n      \"default\": null,\n      \"doc\": \"Custom dimensions or properties for use with reporting or analytics\",\n      \"order\": \"ignore\"\n    },\n    {\n      \"name\":\"user_traits\",\n      \"type\": [\"null\", { \"type\" : \"array\", \"items\":\"string\" }],\n      \"default\": null,\n      \"doc\": \"The traits for the specified user, which allow us to track user engagement by various dynamic classifications of the consumer throughout time. For example heavy, medium, loyal, abandoner, new visitor, etc\",\n      \"order\": \"ignore\"\n    },\n    {\n      \"name\":\"location_admin_zone_0\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ignore\",\n      \"doc\":\"The location administrative level 0 zone that this event was triggered in (see: diva-gis). This is always country level. This differs from country code in that country code is the country that owns the network, not where the user is engaging (for example network is owned by USA but touchpoint happens in Japan)\"\n    },\n    {\n      \"name\":\"location_admin_zone_1\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ignore\",\n      \"doc\":\"The location administrative level 1 zone that this event was triggered in (see: diva-gis). For USA this is the state. Other countries like Japan may use different admin taxonomies. For example 県(KEN)/PREFRECTURE for level 1.\"\n    },\n    {\n      \"name\":\"location_admin_zone_2\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ignore\",\n      \"doc\":\"The location administrative level 2 zone that this event was triggered in (see: diva-gis). For USA this is county. Other countries like  Japan may use different admin taxonomies. For Japan this might be municipality 市(SHI)/CITY for level 2 depending on the size of the municipality.\"\n    },\n    {\n      \"name\":\"user_agent\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ignore\",\n      \"doc\":\"The browser/user agent used by the user to access (in digital/mobile) channels\"\n    },\n    {\n      \"name\":\"user_language\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ignore\",\n      \"doc\":\"The language the user had their device set to when accessing the content\"\n    },\n    {\n      \"name\":\"category_level_1_code\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ignore\",\n      \"doc\":\"The code for the category level 1, which is, if available the identifier for the category level 1 text. Most systems should ignore this value.\"\n    },\n    {\n      \"name\":\"category_level_2_code\",\n      \"type\":[\n        \"null\",\n        \"string\"\n      ],\n      \"default\":null,\n      \"order\":\"ignore\",\n      \"doc\":\"The code for the category level 2, which is, if available the identifier for the category level 2 text. Most systems should ignore this value.\"\n    },\n    {\n      \"name\":\"threshold_balance\",\n      \"type\":[\n        \"null\",\n        \"double\"\n      ],\n      \"default\":null,\n      \"order\":\"ignore\",\n      \"doc\":\"The last balance of the user when dealing with loyalty thresholds.\"\n    },\n    {\n      \"name\":\"threshold_sequence\",\n      \"type\":[\n        \"null\",\n        \"int\"\n      ],\n      \"default\":null,\n      \"order\":\"ignore\",\n      \"doc\":\"The last sequence of the user when dealing with loyalty thresholds\"\n    },\n    {\n      \"name\":\"threshold_reset\",\n      \"type\":[\n        \"null\",\n        \"boolean\"\n      ],\n      \"default\":null,\n      \"order\":\"ignore\",\n      \"doc\":\"A flag indicating if the threshold should be reset.\"\n    },\n    {\n      \"name\":\"gen\",\n      \"type\":[\n        \"null\",\n        \"long\"\n      ],\n      \"default\":null,\n      \"doc\":\"The time (UTC) in milliseconds since epoch that the event was generated. This differs from ts in that it contains the timestamp when the event was received and is used for data extraction and analytics. In Java new Date().getTime()\"\n    },\n    {\n      \"name\":\"client_id\",\n      \"type\":[\n        \"null\",\n        {\n          \"type\":\"string\"\n        }\n      ],\n      \"doc\":\"The client ID that sponsored this advertisement\",\n      \"default\":null,\n      \"order\":\"ignore\"\n    },\n    {\n      \"name\":\"placement_id\",\n      \"type\":[\n        \"null\",\n        {\n          \"type\":\"string\"\n        }\n      ],\n      \"doc\":\"The placement that hosted this advertisement, if any applies\",\n      \"default\":null,\n      \"order\":\"ignore\"\n    },\n    {\n      \"name\":\"bid_id\",\n      \"type\":[\n        \"null\",\n        {\n          \"type\":\"string\"\n        }\n      ],\n      \"doc\":\"The identifier for the bid that won this space\",\n      \"default\":null,\n      \"order\":\"ignore\"\n    },\n    {\n      \"name\":\"exchange_id\",\n      \"type\":[\n        \"null\",\n        {\n          \"type\":\"string\"\n        }\n      ],\n      \"doc\":\"The identifier of the exchange that this advertisement was bid within\",\n      \"default\":null,\n      \"order\":\"ignore\"\n    },\n    {\n      \"name\": \"bid_amount\",\n      \"type\":[\n        \"null\",\n        {\n          \"type\":\"double\"\n        }\n      ],\n      \"doc\":\"The cost/price of the bid that resulted in the win.\",\n      \"default\":null,\n      \"order\":\"ignore\"\n    },\n    {\n      \"name\": \"bid_currency\",\n      \"type\":[\n        \"null\",\n        {\n          \"type\":\"string\"\n        }\n      ],\n      \"doc\":\"The currency of the price, assumed to be what is the country's currency code if not specified\",\n      \"default\":null,\n      \"order\":\"ignore\"\n    },\n    {\n      \"name\":\"ads\",\n      \"type\":[\n        \"null\",\n        {\n          \"type\":\"array\",\n          \"items\":{\n            \"type\":\"record\",\n            \"name\":\"AdMetaData\",\n            \"doc\":\"* Advertising metadata used for tracking and analytic as well as billing and general capturing.\",\n            \"fields\":[\n              {\n                \"name\":\"id\",\n                \"type\":[\n                  \"null\",\n                  \"string\"\n                ],\n                \"doc\":\"The unique ID for this advertisement, for example `USA-BLIP-1234`.\",\n                \"default\":null\n              },\n              {\n                \"name\":\"template_id\",\n                \"type\":[\n                  \"null\",\n                  \"string\"\n                ],\n                \"doc\":\"The template ID that was used when rendering this advertisement. If any was used.\",\n                \"default\":null\n              },\n              {\n                \"name\":\"adunit_id\",\n                \"type\":[\n                  \"null\",\n                  \"string\"\n                ],\n                \"doc\":\"The ad unit that was used when rendering this advertisement. If any was used.\",\n                \"default\":null\n              },\n              {\n                \"name\":\"adunit_type\",\n                \"type\":[\n                  \"null\",\n                  \"string\"\n                ],\n                \"doc\":\"The ad unit that was used when rendering this advertisement. If any was used.\",\n                \"default\":null\n              },\n              {\n                \"name\":\"height\",\n                \"type\":[\n                  \"null\",\n                  \"int\"\n                ],\n                \"doc\":\"The base height of the advertisement. If it was rendered.\",\n                \"default\":null\n              },\n              {\n                \"name\":\"width\",\n                \"type\":[\n                  \"null\",\n                  \"int\"\n                ],\n                \"doc\":\"The base width of the advertisement. If it was rendered.\",\n                \"default\":null\n              },\n              {\n                \"name\":\"url\",\n                \"type\":[\n                  \"null\",\n                  \"string\"\n                ],\n                \"doc\":\"* The URL that can be used to preview the advertisement that was rendered. If it was rendered.\",\n                \"default\":null\n              },\n              {\n                \"name\":\"variables\",\n                \"type\":[\n                  \"null\",\n                  {\n                    \"type\":\"map\",\n                    \"values\":{\n                      \"type\":\"string\"\n                    }\n                  }\n                ],\n                \"doc\":\"The variables associated to this ad, for example 'pin' or other custom variables for the advertisement.\",\n                \"default\":null\n              },\n              {\n                \"name\":\"scores\",\n                \"type\":[\n                  \"null\",\n                  {\n                    \"type\":\"map\",\n                    \"values\":\"double\"\n                  }\n                ],\n                \"doc\":\"The scores associated to this advertisement, if any are applicable.\",\n                \"default\":null\n              }\n            ]\n          }\n        }\n      ],\n      \"default\":null,\n      \"order\":\"ignore\"\n    }\n  ]\n}"

  def readSchema(): Schema = {
    val avroSchema = new Parser().parse(eventSchema)
    avroSchema
  }

  def generateAvroData(schema: Schema): Unit = {

    import scala.collection.JavaConversions._
    val fields: List[Schema.Field] = schema.getFields.toList

    val writer = new SpecificDatumWriter[GenericRecord](schema)
    val out = new ByteArrayOutputStream()
    val encoder: BinaryEncoder = EncoderFactory.get().binaryEncoder(out, null)
    val genericAvroData: GenericRecord = new GenericData.Record(schema)

    fields.foreach(field => println(field.name()))

  }

}
